{% comment %}
  Renders an article card for a given blog with settings to either show the image or not.

  Accepts:
  - blog: {Object} Blog object
  - article: {Object} Article object
  - media_aspect_ratio: {String} The setting changes the aspect ratio of the article image, if shown
  - media_height: {String} The setting changes the height of the article image. Overrides media_aspect_ratio.
  - show_image: {String} The setting either show the article image or not. If it's not included it will show the image by default
  - show_date: {String} The setting either show the article date or not. If it's not included it will not show the image by default
  - show_author: {String} The setting either show the article author or not. If it's not included it will not show the author by default
  - show_badge: {String} The setting either show the blog badge or not.
  - lazy_load: {Boolean} Image should be lazy loaded. Default: true (optional)

  Usage:
  {% render 'article-card' blog: blog, article: article, show_image: section.settings.show_image %}
{% endcomment %}

{%- if article and article != empty -%}
  {%- liquid
    assign ratio = 1
    if media_aspect_ratio != null
      assign ratio = media_aspect_ratio
    endif

    assign firstswords = article.title | truncatewords: 2, '' | escape
    assign newTitle = article.title | remove_first: firstswords
  -%}

  {% comment %} <article aria-labelledby="Article-{{ article.id }}"> {% endcomment %}
  <div class="w-full group transition-all ease-in-out duration-200">
    <div class="hidden lg:block text-center py-10"> 
      <h3 class="font-fredasansstd font-bold text-title_movil uppercase text-dark-charcoal tracking-normal mb-5  lg:group-hover:text-pastel-red  group-hover:transition-colors group-hover:duration-300 group-hover:ease-in-out">
        <a href="{{ article.url }}" class="">
          {{ article.title | truncatewords: 2, '' | escape }}
        </a>
      </h3>
      <p class="font-fredasansstd font-book text-sm text-dark-charcoal tracking-normal">
        <a href="{{ article.url }}" class="">
          {{ newTitle | truncatewords: 7, '' | escape | capitalize }}
        </a>
      </p>
    </div>
    <span
      class="bg-dark-charcoal h-0.5 rounded-full mb-5 hidden w-full mx-auto lg:block lg:group-hover:bg-pastel-red lg:group-hover:h-1 group-hover:transition-all group-hover:duration-150 group-hover:ease-in"
    ></span>
    {%- if show_image == true and article.image -%}
      <div class="relative w-full h-40 lg:h-56 overflow-hidden rounded-md cursor-pointer">
        {% comment %}theme-check-disable ImgLazyLoading{% endcomment %}
        <img
          srcset="
            {%- if article.image.src.width >= 165 -%}{{ article.image.src | image_url: width: 165 }} 165w,{%- endif -%}
            {%- if article.image.src.width >= 360 -%}{{ article.image.src | image_url: width: 360 }} 360w,{%- endif -%}
            {%- if article.image.src.width >= 533 -%}{{ article.image.src | image_url: width: 533 }} 533w,{%- endif -%}
            {%- if article.image.src.width >= 720 -%}{{ article.image.src | image_url: width: 720 }} 720w,{%- endif -%}
            {%- if article.image.src.width >= 1000 -%}{{ article.image.src | image_url: width: 1000 }} 1000w,{%- endif -%}
            {%- if article.image.src.width >= 1500 -%}{{ article.image.src | image_url: width: 1500 }} 1500w,{%- endif -%}
            {{ article.image.src | image_url }} {{ article.image.src.width }}w
          "
          src="{{ article.image.src | image_url: width: 533 }}"
          sizes="(min-width: {{ settings.page_width }}px) {{ settings.page_width | minus: 100 | divided_by: 2 }}px, (min-width: 750px) calc((100vw - 130px) / 2), calc((100vw - 50px) / 2)"
          alt="{{ article.image.src.alt | escape }}"
          class="absolute w-full h-full object-cover aspect-auto left-0 top-0 right-0 bottom-0"
          loading="lazy"
          width="{{ article.image.width }}"
          height="{{ article.image.height }}"
        >
        {% comment %}theme-check-enable ImgLazyLoading{% endcomment %}
      </div>
    {%- endif -%}
    <div class="pt-3.5">
      <h3 class="font-fredasansstd font-bold text-xs tracking-normal text-pastel-red mb-3 lg:hidden">
        <a href="{{ article.url }}" class=""> 
          {{ article.title | truncate: 50 | escape | capitalize }}
        </a>
      </h3>
      <span class="bg-pastel-red h-0.5 rounded-full mb-1 block w-full mx-auto lg:hidden"></span>
      <div class="pb-2 text-start flex flex-col">
        {%- if show_author -%}
          <span class="font-fredasansstd tracking-normal font-book text-xs text-chinese-silver capitalize">{{ article.author }}</span>
        {%- endif -%}
        {%- if show_date -%}
          <span class="font-fredasansstd tracking-normal font-book text-xs text-chinese-silver lowercase">
            {{- article.published_at | time_tag: format: 'date' -}}
          </span>
        {%- endif -%}
      </div>
      {%- if show_excerpt -%}
        {%- if article.excerpt.size > 0 or article.content.size > 0 -%}
          <p class="font-fredasansstd font-book text-xs text-dark-charcoal tracking-normal text-start mt-3 mb-4">
            {%- if article.excerpt.size > 0 -%}
              {{ article.excerpt | strip_html | truncatewords: 31, '...' }}
            {%- else -%}
              {{ article.content | strip_html | truncatewords: 31, '...' }}
            {%- endif -%}
          </p>
        {%- endif -%}
        <div class="article-card__footer">
          {%- if article.comments_count > 0 and blog.comments_enabled? -%}
            <span>{{ 'blogs.article.comments' | t: count: article.comments_count }}</span>
          {%- endif -%}
        </div>
      {%- endif -%} 
      <a
        href="{{ article.url }}"
        class="text-start font-fredasansstd font-bold text-xs tracking-normal lg:text-sm text-dark-charcoal underline"
      >
        Leer m√°s...
      </a>
    </div>
  </div>
{%- endif -%}
